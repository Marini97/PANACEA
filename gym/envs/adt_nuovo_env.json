{
  "metadata": {
    "goal": "DataExfiltration",
    "actions_to_goal": [
      "exfiltrateData"
    ],
    "initial_attributes": [
      "UnencryptedFiles",
      "SOCKS5ProxyActive",
      "MisconfiguredApache",
      "WebserverPubliclyExposed",
      "CGIscriptsenabled",
      "VulnerableApacheHTTPServerVersion",
      "WebserverPubliclyExposed"
    ],
    "environment_type": "attack_defense_tree",
    "time_based": false
  },
  "state_space": {
    "DataExfiltration": {
      "type": "discrete",
      "low": 0,
      "high": 1,
      "description": "Goal achievement state"
    },
    "current_player": {
      "type": "discrete",
      "low": 0,
      "high": 1,
      "description": "Current player (0=attacker, 1=defender)"
    },
    "AccesstoSensitiveFiles": {
      "type": "discrete",
      "low": 0,
      "high": 2,
      "description": "Attacker attribute: AccesstoSensitiveFiles"
    },
    "AccesstoReverseShell": {
      "type": "discrete",
      "low": 0,
      "high": 2,
      "description": "Attacker attribute: AccesstoReverseShell"
    },
    "AccesstoExecuteArbitraryCode": {
      "type": "discrete",
      "low": 0,
      "high": 2,
      "description": "Attacker attribute: AccesstoExecuteArbitraryCode"
    },
    "AccesstoMySQL": {
      "type": "discrete",
      "low": 0,
      "high": 2,
      "description": "Attacker attribute: AccesstoMySQL"
    },
    "WebReconSuccesful": {
      "type": "discrete",
      "low": 0,
      "high": 2,
      "description": "Attacker attribute: WebReconSuccesful"
    },
    "UnencryptedFiles": {
      "type": "discrete",
      "low": 1,
      "high": 2,
      "description": "Initial system attribute: UnencryptedFiles"
    },
    "SOCKS5ProxyActive": {
      "type": "discrete",
      "low": 1,
      "high": 2,
      "description": "Initial system attribute: SOCKS5ProxyActive"
    },
    "MisconfiguredApache": {
      "type": "discrete",
      "low": 1,
      "high": 2,
      "description": "Initial system attribute: MisconfiguredApache"
    },
    "WebserverPubliclyExposed": {
      "type": "discrete",
      "low": 1,
      "high": 2,
      "description": "Initial system attribute: WebserverPubliclyExposed"
    },
    "CGIscriptsenabled": {
      "type": "discrete",
      "low": 1,
      "high": 2,
      "description": "Initial system attribute: CGIscriptsenabled"
    },
    "VulnerableApacheHTTPServerVersion": {
      "type": "discrete",
      "low": 1,
      "high": 2,
      "description": "Initial system attribute: VulnerableApacheHTTPServerVersion"
    }
  },
  "action_space": {
    "attacker": {
      "type": "discrete",
      "actions": {
        "0": {
          "name": "exfiltrateData",
          "preconditions": {
            "conditions": [
              "AccesstoMySQL",
              "AccesstoExecuteArbitraryCode"
            ],
            "logic": "OR",
            "required_values": {
              "AccesstoMySQL": 1,
              "AccesstoExecuteArbitraryCode": 1
            }
          },
          "effect": "DataExfiltration",
          "cost": 50,
          "refinement": "disjunctive"
        },
        "1": {
          "name": "getLoginData",
          "preconditions": {
            "conditions": [
              "AccesstoSensitiveFiles",
              "UnencryptedFiles"
            ],
            "logic": "AND",
            "required_values": {
              "AccesstoSensitiveFiles": 1,
              "UnencryptedFiles": 1
            }
          },
          "effect": "AccesstoMySQL",
          "cost": 10,
          "refinement": "conjunctive"
        },
        "2": {
          "name": "bufferOverflow",
          "preconditions": {
            "conditions": [
              "SOCKS5ProxyActive",
              "WebReconSuccesful"
            ],
            "logic": "AND",
            "required_values": {
              "SOCKS5ProxyActive": 1,
              "WebReconSuccesful": 1
            }
          },
          "effect": "AccesstoExecuteArbitraryCode",
          "cost": 40,
          "refinement": "conjunctive"
        },
        "3": {
          "name": "getFiles",
          "preconditions": {
            "conditions": [
              "MisconfiguredApache",
              "AccesstoReverseShell"
            ],
            "logic": "AND",
            "required_values": {
              "MisconfiguredApache": 1,
              "AccesstoReverseShell": 1
            }
          },
          "effect": "AccesstoSensitiveFiles",
          "cost": 30,
          "refinement": "conjunctive"
        },
        "4": {
          "name": "webRecon",
          "preconditions": {
            "conditions": [
              "WebserverPubliclyExposed"
            ],
            "logic": "OR",
            "required_values": {
              "WebserverPubliclyExposed": 1
            }
          },
          "effect": "WebReconSuccesful",
          "cost": 5,
          "refinement": "disjunctive"
        },
        "5": {
          "name": "pathTraversal",
          "preconditions": {
            "conditions": [
              "CGIscriptsenabled",
              "VulnerableApacheHTTPServerVersion",
              "WebReconSuccesful"
            ],
            "logic": "AND",
            "required_values": {
              "CGIscriptsenabled": 1,
              "VulnerableApacheHTTPServerVersion": 1,
              "WebReconSuccesful": 1
            }
          },
          "effect": "AccesstoReverseShell",
          "cost": 20,
          "refinement": "conjunctive"
        }
      }
    },
    "defender": {
      "type": "discrete",
      "actions": {
        "0": {
          "name": "changeCredentials",
          "preconditions": {
            "conditions": [],
            "logic": "AND",
            "required_values": {}
          },
          "effect": "AccesstoMySQL",
          "cost": 200,
          "refinement": "conjunctive"
        },
        "1": {
          "name": "changeFilePermissions",
          "preconditions": {
            "conditions": [],
            "logic": "AND",
            "required_values": {}
          },
          "effect": "AccesstoSensitiveFiles",
          "cost": 60,
          "refinement": "conjunctive"
        },
        "2": {
          "name": "encryptFile",
          "preconditions": {
            "conditions": [],
            "logic": "OR",
            "required_values": {}
          },
          "effect": "UnencryptedFiles",
          "cost": 150,
          "refinement": "disjunctive"
        },
        "3": {
          "name": "deactivateSOCKS5Proxy",
          "preconditions": {
            "conditions": [],
            "logic": "AND",
            "required_values": {}
          },
          "effect": "SOCKS5ProxyActive",
          "cost": 120,
          "refinement": "conjunctive"
        },
        "4": {
          "name": "reconfigureApache",
          "preconditions": {
            "conditions": [],
            "logic": "AND",
            "required_values": {}
          },
          "effect": "MisconfiguredApache",
          "cost": 50,
          "refinement": "conjunctive"
        },
        "5": {
          "name": "disableCGIScripts",
          "preconditions": {
            "conditions": [],
            "logic": "AND",
            "required_values": {}
          },
          "effect": "CGIscriptsenabled",
          "cost": 45,
          "refinement": "conjunctive"
        },
        "6": {
          "name": "updateApache",
          "preconditions": {
            "conditions": [],
            "logic": "AND",
            "required_values": {}
          },
          "effect": "VulnerableApacheHTTPServerVersion",
          "cost": 20,
          "refinement": "conjunctive"
        }
      }
    }
  },
  "transitions": {
    "attacker": {
      "exfiltrateData": {
        "effects": {
          "DataExfiltration": 1,
          "current_player": 1
        }
      },
      "getLoginData": {
        "effects": {
          "AccesstoMySQL": 1,
          "current_player": 1
        }
      },
      "bufferOverflow": {
        "effects": {
          "AccesstoExecuteArbitraryCode": 1,
          "current_player": 1
        }
      },
      "getFiles": {
        "effects": {
          "AccesstoSensitiveFiles": 1,
          "current_player": 1
        }
      },
      "webRecon": {
        "effects": {
          "WebReconSuccesful": 1,
          "current_player": 1
        }
      },
      "pathTraversal": {
        "effects": {
          "AccesstoReverseShell": 1,
          "current_player": 1
        }
      }
    },
    "defender": {
      "changeCredentials": {
        "effects": {
          "AccesstoMySQL": 2,
          "current_player": 0
        }
      },
      "changeFilePermissions": {
        "effects": {
          "AccesstoSensitiveFiles": 2,
          "current_player": 0
        }
      },
      "encryptFile": {
        "effects": {
          "UnencryptedFiles": 2,
          "current_player": 0
        }
      },
      "deactivateSOCKS5Proxy": {
        "effects": {
          "SOCKS5ProxyActive": 2,
          "current_player": 0
        }
      },
      "reconfigureApache": {
        "effects": {
          "MisconfiguredApache": 2,
          "current_player": 0
        }
      },
      "disableCGIScripts": {
        "effects": {
          "CGIscriptsenabled": 2,
          "current_player": 0
        }
      },
      "updateApache": {
        "effects": {
          "VulnerableApacheHTTPServerVersion": 2,
          "current_player": 0
        }
      }
    }
  },
  "rewards": {
    "attacker": {
      "exfiltrateData": -50,
      "getLoginData": -10,
      "bufferOverflow": -40,
      "getFiles": -30,
      "webRecon": -5,
      "pathTraversal": -20
    },
    "defender": {
      "changeCredentials": -200,
      "changeFilePermissions": -60,
      "encryptFile": -150,
      "deactivateSOCKS5Proxy": -120,
      "reconfigureApache": -50,
      "disableCGIScripts": -45,
      "updateApache": -20
    },
    "cost_penalty": 10,
    "terminal_rewards": {
      "exfiltrateData": -500
    },
    "win_bonus": 100,
    "lose_penalty": -100
  },
  "initial_state": {
    "DataExfiltration": 0,
    "current_player": 0,
    "UnencryptedFiles": 1,
    "SOCKS5ProxyActive": 1,
    "MisconfiguredApache": 1,
    "WebserverPubliclyExposed": 1,
    "CGIscriptsenabled": 1,
    "VulnerableApacheHTTPServerVersion": 1
  },
  "terminal_states": [
    {
      "condition": "DataExfiltration == 1",
      "description": "Goal achieved by attacker"
    }
  ]
}